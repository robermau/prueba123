{
  "version": 3,
  "sources": ["../../../app/routes/projects.volkihar-knight/armor.jsx", "../../../app/routes/projects.volkihar-knight/armor.module.css"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app\\\\\\\\routes\\\\\\\\projects.volkihar-knight\\\\\\\\armor.jsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app\\\\routes\\\\projects.volkihar-knight\\\\armor.jsx\");\n}\n// REMIX HMR END\n\nimport vknx from '~/assets/volkihar-cube-nx.jpg';\nimport vkny from '~/assets/volkihar-cube-ny.jpg';\nimport vknz from '~/assets/volkihar-cube-nz.jpg';\nimport vkpx from '~/assets/volkihar-cube-px.jpg';\nimport vkpy from '~/assets/volkihar-cube-py.jpg';\nimport vkpz from '~/assets/volkihar-cube-pz.jpg';\nimport armor from '~/assets/volkihar-knight.glb';\nimport { Loader } from '~/components/loader';\nimport { tokens } from '~/components/theme-provider/theme';\nimport { Transition } from '~/components/transition';\nimport { useReducedMotion, useSpring } from 'framer-motion';\nimport { useInViewport } from '~/hooks';\nimport { startTransition, useCallback, useEffect, useRef, useState } from 'react';\nimport { ACESFilmicToneMapping, CubeTextureLoader, DirectionalLight, Group, PMREMGenerator, PerspectiveCamera, Scene, WebGLRenderer, MathUtils, SRGBColorSpace } from 'three';\nimport { classes, cssProps, msToNum, numToMs } from '~/utils/style';\nimport { cleanRenderer, cleanScene, modelLoader, removeLights } from '~/utils/three';\nimport { throttle } from '~/utils/throttle';\nimport styles from './armor.module.css';\nconst rotationSpringConfig = {\n  stiffness: 40,\n  damping: 20,\n  mass: 1.5\n};\nexport const Armor = ({\n  showDelay = 0,\n  cameraPosition = {\n    x: 0,\n    y: 0,\n    z: 6\n  },\n  className,\n  alt,\n  ...rest\n}) => {\n  _s();\n  const [loaded, setLoaded] = useState(false);\n  const [visible, setVisible] = useState(false);\n  const [loaderVisible, setLoaderVisible] = useState(false);\n  const container = useRef();\n  const canvas = useRef();\n  const camera = useRef();\n  const modelGroup = useRef();\n  const scene = useRef();\n  const renderer = useRef();\n  const lights = useRef();\n  const isInViewport = useInViewport(container, false, {\n    threshold: 0.4\n  });\n  const reduceMotion = useReducedMotion();\n  const rotationX = useSpring(0, rotationSpringConfig);\n  const rotationY = useSpring(0, rotationSpringConfig);\n  useEffect(() => {\n    const {\n      clientWidth,\n      clientHeight\n    } = container.current;\n    renderer.current = new WebGLRenderer({\n      canvas: canvas.current,\n      alpha: true,\n      antialias: false,\n      powerPreference: 'high-performance',\n      failIfMajorPerformanceCaveat: true\n    });\n    renderer.current.setPixelRatio(2);\n    renderer.current.setSize(clientWidth, clientHeight);\n    renderer.current.outputColorSpace = SRGBColorSpace;\n    renderer.current.toneMapping = ACESFilmicToneMapping;\n    camera.current = new PerspectiveCamera(36, clientWidth / clientHeight, 0.1, 100);\n    camera.current.position.set(cameraPosition.x, cameraPosition.y, cameraPosition.z);\n    scene.current = new Scene();\n    const cubeTextureLoader = new CubeTextureLoader();\n    modelGroup.current = new Group();\n    scene.current.add(modelGroup.current);\n    const pmremGenerator = new PMREMGenerator(renderer.current);\n    pmremGenerator.compileCubemapShader();\n\n    // Lighting\n    const keyLight = new DirectionalLight(0xffffff, 2.6);\n    const fillLight = new DirectionalLight(0xffffff, 1.0);\n    const backLight = new DirectionalLight(0xffffff, 1.3);\n    keyLight.position.set(1, 0.1, 2);\n    fillLight.position.set(-1, 0.1, 8);\n    backLight.position.set(-2, 2, -3);\n    lights.current = [backLight, keyLight, fillLight];\n    lights.current.forEach(light => scene.current.add(light));\n    const load = async () => {\n      const loadGltf = modelLoader.loadAsync(armor);\n      const loadEnv = cubeTextureLoader.loadAsync([vknx, vkny, vknz, vkpx, vkpy, vkpz]);\n      const [gltf, envTexture] = await Promise.all([loadGltf, loadEnv]);\n      modelGroup.current.add(gltf.scene);\n      gltf.scene.rotation.y = MathUtils.degToRad(180);\n      gltf.scene.position.y = -1.6;\n      const {\n        texture\n      } = pmremGenerator.fromCubemap(envTexture);\n      scene.current.environment = texture;\n      pmremGenerator.dispose();\n      await renderer.current.initTexture(scene.current.environment);\n      modelGroup.current.traverse(async node => {\n        if (node.material) {\n          await renderer.current.initTexture(node.material);\n        }\n      });\n      setLoaded(true);\n      renderFrame();\n    };\n    startTransition(() => {\n      load();\n      setTimeout(() => {\n        setLoaderVisible(true);\n      }, 1000);\n    });\n    const unsubscribeX = rotationX.on('change', value => {\n      modelGroup.current.rotation.x = value;\n      renderFrame();\n    });\n    const unsubscribeY = rotationY.on('change', value => {\n      modelGroup.current.rotation.y = value;\n      renderFrame();\n    });\n    return () => {\n      removeLights(lights.current);\n      cleanScene(scene.current);\n      cleanRenderer(renderer.current);\n      unsubscribeX();\n      unsubscribeY();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Handle render passes for a single frame\n  const renderFrame = useCallback(() => {\n    renderer.current.render(scene.current, camera.current);\n  }, []);\n\n  // Handle mouse move animation\n  useEffect(() => {\n    const onMouseMove = throttle(event => {\n      const {\n        innerWidth,\n        innerHeight\n      } = window;\n      const position = {\n        x: (event.clientX - innerWidth / 2) / innerWidth,\n        y: (event.clientY - innerHeight / 2) / innerHeight\n      };\n      rotationX.set(position.y / 2);\n      rotationY.set(position.x / 2);\n    }, 100);\n    if (isInViewport) {\n      setVisible(true);\n    }\n    if (isInViewport && !reduceMotion) {\n      window.addEventListener('mousemove', onMouseMove);\n    }\n    return () => {\n      window.removeEventListener('mousemove', onMouseMove);\n    };\n  }, [isInViewport, reduceMotion, rotationX, rotationY]);\n\n  // Handle window resize\n  useEffect(() => {\n    const handleResize = () => {\n      if (!container.current) return;\n      const {\n        clientWidth,\n        clientHeight\n      } = container.current;\n      renderer.current.setSize(clientWidth, clientHeight);\n      camera.current.aspect = clientWidth / clientHeight;\n      camera.current.updateProjectionMatrix();\n      renderFrame();\n    };\n    window.addEventListener('resize', handleResize);\n    handleResize();\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [renderFrame]);\n  return <div className={classes(styles.armor, className)} ref={container} role=\"img\" aria-label={alt} {...rest}>\n      \r\n      <Transition unmount in={!loaded && loaderVisible} timeout={msToNum(tokens.base.durationL)}>\n        \r\n        {({\n        visible\n      }) => <Loader className={styles.loader} data-visible={visible} />}\r\n      </Transition>\r\n      <canvas className={styles.canvas} ref={canvas} data-loaded={loaded && visible} style={cssProps({\n      delay: numToMs(showDelay)\n    })} />\n      \r\n    </div>;\n};\n_s(Armor, \"5eBfin4pBCDeANjClIy0HE/UCtE=\", false, function () {\n  return [useInViewport, useReducedMotion, useSpring, useSpring];\n});\n_c = Armor;\nvar _c;\n$RefreshReg$(_c, \"Armor\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;", "export default {\"armor\":\"armor-module__armor__bN7R0\",\"loader\":\"armor-module__loader__JIDiX\",\"canvas\":\"armor-module__canvas__Jnb1A\"};"],
  "mappings": "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",
  "names": ["visible"]
}
